<h1>Productos</h1>

<ul>
    {{#each payload}}
    <li>
        <strong>{{this.title}}</strong> - ${{this.price}}
        <a href="/products/{{this._id}}">ver</a>
        <button class="btn-add" data-id="{{this._id}}">Agregar al carrito</button>
    </li>
    {{/each}}
</ul>

<nav>
    {{#if hasPrevPage}} <a href="{{prevLink}}">« anterior</a> {{/if}}
    <span>Página {{page}} / {{totalPages}}</span>
    {{#if hasNextPage}} <a href="{{nextLink}}">siguiente »</a> {{/if}}
</nav>

<script>
    document.addEventListener('click', async (e) => {
        if (e.target.matches('.btn-add')) {
            const pid = e.target.dataset.id;
            await fetch(`/api/carts/1/product/${pid}`, { method: 'POST' });
            alert('Agregado!');
        }
    });
</script>